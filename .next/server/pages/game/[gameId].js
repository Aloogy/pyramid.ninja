"use strict";(()=>{var e={};e.id=822,e.ids=[636,822],e.modules={361:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},549:(e,t,s)=>{s.a(e,async(e,a)=>{try{s.r(t),s.d(t,{default:()=>g});var r=s(8732),l=s(2015),o=s(4233),n=s(9918),i=s.n(n),d=s(9522),c=s(5997),u=s(1321),h=s(2506),m=s(4670),p=s(1043),x=s(224),f=e([h,m]);[h,m]=f.then?(await f)():f;let g=()=>{let{gameId:e}=(0,o.useRouter)().query,{gameData:t,players:s}=(0,h.Im)(),{userUid:a}=(0,m.As)(),{playSound:n}=(0,p.f)(),[f,g]=(0,l.useState)(null),[b,y]=(0,l.useState)([]),[v,w]=(0,l.useState)(!1),[j,N]=(0,l.useState)("Waiting for host to continue..."),[S,_]=(0,l.useState)(!1),[k,C]=(0,l.useState)(0),[M,R]=(0,l.useState)(null),[P,z]=(0,l.useState)(null),[A,Y]=(0,l.useState)(null),[q,B]=(0,l.useState)(!1),[E,T]=(0,l.useState)(0),[H,W]=(0,l.useState)(!1),[$,G]=(0,l.useState)(null),[I,D]=(0,l.useState)(!1),[F,L]=(0,l.useState)(!1),[V,O]=(0,l.useState)(!1),[U,X]=(0,l.useState)(!1),[J,K]=(0,l.useState)(!1),[Q,Z]=(0,l.useState)(null),[ee,et]=(0,l.useState)(-1),[es,ea]=(0,l.useState)(!1),er=(0,l.useRef)(null);(0,l.useEffect)(()=>{let e=localStorage.getItem("playerName");e&&g(e)},[]),(0,l.useEffect)(()=>{if(k>0)return er.current=setTimeout(()=>{C(k-1)},1e3),()=>{er.current&&clearTimeout(er.current)};0===k&&S&&(_(!1),t&&a&&t[a]&&(y(e=>e.map(e=>({...e,seen:!0}))),N("Waiting for host to continue...")))},[k,S,t,a]),(0,l.useEffect)(()=>{if(!t||!a||!e)return;let r=t[a];if(r){if(r.cards&&y(r.cards),t["__pyramid.meta"].started?(w(!0),r.cards?.every(e=>e.seen)||t["__pyramid.currentRound"]||(N("Press the button below to view your cards. You will have just 10 seconds to remember them! Tip: You can drag your cards around to re-order them."),O(!0),L(!1))):(N("Waiting for host to continue..."),s.length>1?D(!0):D(!1)),t["__pyramid.currentRound"]){let{round_number:e,round_row:r,round_card:l}=t["__pyramid.currentRound"];R(e),z(r),Y((0,x.NR)(l)),O(!1),K(!1);let o=!0;if(t["__pyramid.rounds"]&&t["__pyramid.rounds"][e]&&t["__pyramid.rounds"][e].round_transactions){let l=t["__pyramid.rounds"][e].round_transactions;l.some(e=>e.t_from===a)&&(o=!1,N("You have sent drinks already - please wait for updates or the round to finish..."));let i=0;l.forEach((e,t)=>{if(e.t_to===a&&"waiting"===e.status){let a=s.find(t=>t.uid===e.t_from);a&&(Z({from_player:a.name,to_player:f||"You"}),et(t),n("notification"),N("drink"),K(!0),L(!1),o=!1)}if(e.t_from===a&&"bullshit"===e.status){let a=s.find(t=>t.uid===e.t_to);a&&(Z({from_player:f||"You",to_player:a.name}),et(t),n("bullshit"),N("bullshit"),B(!0),L(!1),o=!1)}e.t_to===a&&"accepted"===e.status&&(i+=+r),e.t_from===a&&"bullshit_wrong"===e.status&&(i+=2*r),e.t_to===a&&"bullshit_correct"===e.status&&(i+=2*r)}),T(i)}o&&!q&&(N("To call someone to drink use the button below!"),L(!0))}t["__pyramid.summary"]&&(ea(!0),N("Game Over! Here are your final cards:"),_(!0))}},[t,a,e,s,f,n]);let el=async()=>{if(a&&e&&$&&null!==M)try{L(!1),W(!1),G(null),N("Waiting for player to respond...")}catch(e){console.error("Failed to call player:",e)}},eo=async t=>{if(a&&e&&null!==M&&-1!==ee)try{K(!1),Z(null),t?N("You accepted the drinks!"):N("You called bullshit! The player now needs to show a matching card.")}catch(e){console.error("Failed to process decision:",e)}},en=async()=>{if(q&&a&&e&&null!==M)try{B(!1),X(!0),N("You showed your card! Click below to get a new card.")}catch(e){console.error("Failed to process bullshit response:",e)}},ei=async()=>{if(e)try{D(!1),N("Starting game...")}catch(e){console.error("Failed to start game:",e)}};return(0,r.jsxs)(d.A,{pageTitle:`Game ${String(e).toUpperCase()}`,children:[(0,r.jsx)("div",{className:"container mx-auto px-4 pt-6 pb-20",children:(0,r.jsxs)("div",{className:"bg-white bg-opacity-90 rounded-xl shadow-lg overflow-hidden relative",children:[e&&(0,r.jsxs)("div",{className:"absolute top-2 right-2 bg-indigo-800 text-white px-3 py-1 rounded-full text-sm font-bold",children:["Room: ",String(e).toUpperCase()]}),f&&(0,r.jsx)("div",{className:"absolute top-2 left-2 bg-rose-600 text-white px-3 py-1 rounded-full text-sm font-bold",children:f}),k>0&&(0,r.jsxs)("div",{className:"absolute top-10 right-2 bg-amber-500 text-white px-3 py-1 rounded-full text-sm font-bold",children:[k,"s"]}),(0,r.jsx)("div",{className:"p-6 pt-14",children:v?(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-center mb-6",children:es?(0,r.jsx)("h2",{className:"text-xl font-bold",children:"That's the end of the game! You can see your final cards below!"}):(0,r.jsxs)(r.Fragment,{children:[null!==M&&A&&(0,r.jsxs)("h3",{className:"text-lg font-semibold mb-1",children:[(0,r.jsxs)("span",{className:"text-gray-600",children:["Row ",P,", round ",M," - it's"," "]}),(0,r.jsx)("span",{className:"text-black",children:A}),(0,r.jsx)("span",{className:"text-gray-600",children:"!"})]}),"bullshit"===j?(0,r.jsxs)("h3",{className:"text-lg",children:["What's this?"," ",(0,r.jsx)("span",{className:"font-bold",children:Q?.to_player})," ","has called"," ",(0,r.jsx)("span",{className:"font-bold text-rose-600",children:"BULLSHIT"}),"! Select the card with the"," ",(0,r.jsx)("span",{className:"font-bold",children:"same"})," rank as the card in play below - or face drinking double!",E>0&&(0,r.jsxs)("span",{className:"text-gray-600 block mt-1",children:["By the way you already need to drink ",E," ","this round!"]})]}):"drink"===j?(0,r.jsxs)("h3",{className:"text-lg",children:[(0,r.jsx)("span",{className:"font-bold",children:Q?.from_player})," ","has asked you to drink! Decide what to do by choosing a button below."]}):"several_drink"===j?(0,r.jsxs)("h3",{className:"text-lg",children:["You have been called to drink by"," ",(0,r.jsx)("span",{className:"font-bold",children:"multiple"})," other players! We'll begin with"," ",(0,r.jsx)("span",{className:"font-bold",children:Q?.from_player}),". Decide what to do by choosing a button below."]}):(0,r.jsxs)("h3",{className:"text-lg",children:[j," ",E>0&&(0,r.jsxs)("span",{className:"font-semibold text-rose-600",children:["You need to drink ",E," this round!"]})]})]})}),(0,r.jsx)("div",{className:"mb-8",children:(0,r.jsx)(c.A,{cards:b,showAllCards:S,countdownActive:k>0,onCardSelect:q?en:void 0})}),(0,r.jsxs)("div",{className:"flex flex-wrap justify-center gap-4 mt-6",children:[V&&(0,r.jsxs)("button",{onClick:()=>{_(!0),O(!1),C(10),N("Remember your cards now! You will NOT be able to view them again!")},className:"bg-rose-500 hover:bg-rose-600 text-white font-bold py-2 px-6 rounded-full transition duration-300 flex items-center",children:["Show My Cards",(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 ml-2",viewBox:"0 0 20 20",fill:"currentColor",children:[(0,r.jsx)("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),(0,r.jsx)("path",{fillRule:"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z",clipRule:"evenodd"})]})]}),U&&(0,r.jsxs)("button",{onClick:()=>{_(!0),X(!1),C(15),N("Remember your new card! You will NOT be able to view it again!")},className:"bg-rose-500 hover:bg-rose-600 text-white font-bold py-2 px-6 rounded-full transition duration-300 flex items-center",children:["Get New Card",(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 ml-2",viewBox:"0 0 20 20",fill:"currentColor",children:[(0,r.jsx)("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),(0,r.jsx)("path",{fillRule:"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z",clipRule:"evenodd"})]})]}),F&&(0,r.jsxs)("button",{onClick:()=>{W(!0)},className:"bg-rose-500 hover:bg-rose-600 text-white font-bold py-2 px-6 rounded-full transition duration-300 flex items-center",children:["Select Player",(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 ml-2",viewBox:"0 0 20 20",fill:"currentColor",children:[(0,r.jsx)("path",{d:"M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"}),(0,r.jsx)("path",{fillRule:"evenodd",d:"M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3zm-3 4a1 1 0 100 2h.01a1 1 0 100-2H7zm3 0a1 1 0 100 2h3a1 1 0 100-2h-3z",clipRule:"evenodd"})]})]}),J&&(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsxs)("button",{onClick:()=>eo(!0),className:"bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-6 rounded-full transition duration-300 flex items-center",children:["Accept Drinks",(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 ml-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]}),(0,r.jsxs)("button",{onClick:()=>eo(!1),className:"bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-6 rounded-full transition duration-300 flex items-center",children:["Bullshit!",(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 ml-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})]})]})]})]}):(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-6",children:"Waiting for host to continue..."}),I&&(0,r.jsxs)("button",{onClick:ei,className:"bg-rose-500 hover:bg-rose-600 text-white font-bold py-3 px-8 rounded-full transition duration-300",children:["Start Game",(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 ml-2 inline",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M10.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L12.586 11H5a1 1 0 110-2h7.586l-2.293-2.293a1 1 0 010-1.414z",clipRule:"evenodd"})})]})]})}),(0,r.jsx)("div",{className:"text-center pb-6",children:(0,r.jsxs)(i(),{href:"/",className:"text-blue-500 hover:text-blue-700 transition duration-300",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 inline mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M3 3a1 1 0 00-1 1v12a1 1 0 102 0V4a1 1 0 00-1-1zm10.293 9.293a1 1 0 001.414 1.414l3-3a1 1 0 000-1.414l-3-3a1 1 0 10-1.414 1.414L14.586 9H7a1 1 0 100 2h7.586l-1.293 1.293z",clipRule:"evenodd"})}),"Exit Game"]})})]})}),H&&(0,r.jsx)(u.A,{players:s.filter(e=>e.uid!==a),onSelectPlayer:e=>{G(e)},selectedPlayer:$,onConfirm:el,onCancel:()=>{W(!1),G(null)},currentCard:A||""})]})};a()}catch(e){a(e)}})},1043:(e,t,s)=>{s.d(t,{f:()=>l});var a=s(2015);let r={notification:1,bullshit:7,success:3,wrong:2},l=()=>{let e=(0,a.useRef)(null),[t,s]=(0,a.useState)(!1);return(0,a.useEffect)(()=>()=>{e.current&&(e.current.pause(),e.current=null)},[]),{playSound:s=>{if(!t&&e.current)try{let t=r[s],a=Math.floor(Math.random()*t)+1;e.current.src=`/assets/sounds/${s}/${a}.mp3`,e.current.play().catch(e=>{console.error("Error playing sound:",e)})}catch(e){console.error("Error playing sound:",e)}},isMuted:t,toggleMute:()=>{let e=!t;return s(e),e}}}},1321:(e,t,s)=>{s.d(t,{A:()=>r});var a=s(8732);s(2015);let r=({players:e,selectedPlayer:t,onSelectPlayer:s,onConfirm:r,onCancel:l,currentCard:o})=>(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsx)("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full overflow-hidden",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Select Player to Drink!"}),(0,a.jsxs)("p",{className:"mb-6",children:[(0,a.jsxs)("span",{className:"font-semibold",children:["Select a player below to tell them you have ",o," and make them drink."]})," ","They can either believe you and take the drinks or call bullshit."]}),0===e.length?(0,a.jsx)("div",{className:"text-center py-4 text-gray-600",children:(0,a.jsx)("h3",{className:"font-bold",children:"Oh no! No other players to send drinks to! :("})}):(0,a.jsx)("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:e.map(e=>(0,a.jsxs)("div",{className:`flex items-center p-3 rounded-lg cursor-pointer transition-colors ${t?.uid===e.uid?"bg-blue-100":"hover:bg-gray-100"}`,onClick:()=>s(e),children:[(0,a.jsx)("input",{type:"radio",name:"playerSelect",checked:t?.uid===e.uid,onChange:()=>s(e),className:"mr-3"}),(0,a.jsx)("img",{src:`https://us-central1-pyramid-ninja.cloudfunctions.net/avatars/70/${e.name}.png`,alt:`${e.name}'s avatar`,className:"w-10 h-10 rounded-full mr-3"}),(0,a.jsx)("span",{className:"font-medium",children:e.name})]},e.uid))}),t&&(0,a.jsx)("div",{className:"mt-4 py-2 border-t border-gray-200",children:(0,a.jsxs)("p",{className:"font-semibold",children:["About to send a drink to: ",t.name]})}),(0,a.jsxs)("div",{className:"flex justify-end gap-3 mt-6",children:[(0,a.jsx)("button",{onClick:l,className:"px-4 py-2 text-gray-700 bg-gray-200 hover:bg-gray-300 rounded-lg transition duration-200",children:"Cancel"}),(0,a.jsx)("button",{onClick:r,disabled:!t,className:`px-4 py-2 text-white bg-rose-500 rounded-lg transition duration-200 ${t?"hover:bg-rose-600":"opacity-50 cursor-not-allowed"}`,children:"Confirm"})]})]})})})},2015:e=>{e.exports=require("react")},2326:e=>{e.exports=require("react-dom")},3646:e=>{e.exports=require("seedrandom")},3873:e=>{e.exports=require("path")},4075:e=>{e.exports=require("zlib")},4337:e=>{e.exports=import("firebase/firestore")},5997:(e,t,s)=>{s.d(t,{A:()=>n});var a=s(8732),r=s(2015),l=s(2743),o=s(224);let n=({cards:e,onCardSelect:t,showAllCards:s=!1,countdownActive:n=!1,className:i=""})=>{let[d,c]=(0,r.useState)([]);(0,r.useEffect)(()=>{e&&c(s?Array(e.length).fill(!0):e.map(e=>e.seen))},[e,s]),(0,r.useEffect)(()=>{!n&&s&&c(e.map(e=>e.seen))},[n,s,e]);let u=e=>{t&&t(e)};return(0,a.jsx)("div",{className:`relative mx-auto ${i}`,style:{width:"400px",height:"350px"},children:e.map((e,s)=>{let r=(0,o.B5)(s),n=r.x+200-50,i=r.y;return(0,a.jsx)(l.A,{index:e.i,position:{x:n,y:i},faceUp:d[s],draggable:!0,onClick:()=>u(s),className:`transition-transform duration-300 ease-out ${t?"hover:scale-105 cursor-pointer":""}`},s)})})}},6551:e=>{e.exports=import("firebase/app")},6958:e=>{e.exports=import("firebase/auth")},7213:(e,t,s)=>{s.a(e,async(e,a)=>{try{s.r(t),s.d(t,{config:()=>x,default:()=>u,getServerSideProps:()=>p,getStaticPaths:()=>m,getStaticProps:()=>h,reportWebVitals:()=>f,routeModule:()=>j,unstable_getServerProps:()=>v,unstable_getServerSideProps:()=>w,unstable_getStaticParams:()=>y,unstable_getStaticPaths:()=>b,unstable_getStaticProps:()=>g});var r=s(3885),l=s(237),o=s(1413),n=s(1779),i=s(2081),d=s(549),c=e([i,d]);[i,d]=c.then?(await c)():c;let u=(0,o.M)(d,"default"),h=(0,o.M)(d,"getStaticProps"),m=(0,o.M)(d,"getStaticPaths"),p=(0,o.M)(d,"getServerSideProps"),x=(0,o.M)(d,"config"),f=(0,o.M)(d,"reportWebVitals"),g=(0,o.M)(d,"unstable_getStaticProps"),b=(0,o.M)(d,"unstable_getStaticPaths"),y=(0,o.M)(d,"unstable_getStaticParams"),v=(0,o.M)(d,"unstable_getServerProps"),w=(0,o.M)(d,"unstable_getServerSideProps"),j=new r.PagesRouteModule({definition:{kind:l.A.PAGES,page:"/game/[gameId]",pathname:"/game/[gameId]",bundlePath:"",filename:""},components:{App:i.default,Document:n.default},userland:d});a()}catch(e){a(e)}})},7910:e=>{e.exports=require("stream")},7912:e=>{e.exports=require("next/head")},8444:e=>{e.exports=import("firebase/analytics")},8732:e=>{e.exports=require("react/jsx-runtime")},9021:e=>{e.exports=require("fs")},9970:e=>{e.exports=import("firebase/performance")}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[341,844,81,354],()=>s(7213));module.exports=a})();